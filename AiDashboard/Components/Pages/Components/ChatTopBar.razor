@inject DashboardState Dashboard
@implements IDisposable

<div class="oa-topbar">
    <div class="oa-badges">
        <span class="oa-badge @(Dashboard.SettingsService.RagMode ? "green" : "gray")">
            RAG: @(Dashboard.SettingsService.RagMode ? "ON" : "OFF")
        </span>
        <span class="oa-badge blue">
            Model: @Dashboard.ModelService.CurrentModel
        </span>
        <span class="oa-badge purple">
            Temperature: @Dashboard.SettingsService.Temperature.ToString("0.0")
        </span>
        <span class="oa-badge @(Dashboard.SettingsService.UseGpu ? "orange" : "gray")">
            GPU: @(Dashboard.SettingsService.UseGpu ? "ON (34)" : "OFF (0)")
        </span>
    </div>
</div>

@code {
    protected override void OnInitialized()
    {
        // Subscribe to state changes so UI updates when model/RAG changes
        Dashboard.OnChange += HandleStateChanged;
    }

    private void HandleStateChanged()
    {
        _ = InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        // Unsubscribe to prevent memory leaks
        Dashboard.OnChange -= HandleStateChanged;
    }
}
